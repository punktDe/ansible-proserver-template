---
################################################################################
# Ansible                                                                      #
################################################################################
#- name: Ansible
#  connection: local
#  hosts: all
#  become: no
#  gather_facts: no
#  any_errors_fatal: yes
#  tasks:
#    - name: >
#        Ansible {{ i.major }}.{{ i.minor }}.{{ i.revision }} ==
#        Ansible {{ s.major }}.{{ s.minor }}.{{ s.revision }}
#      fail:
#        msg: Ansible version is unsupported
#      failed_when: >
#        (s.major != "*" and i.major != s.major) or
#        (s.minor != "*" and i.minor != s.minor) or
#        (s.revision != "*" and i.revision != s.revision)
#      vars:
#        i: "{{ ansible_version }}"
#        s: "{{ supported_ansible_version }}"


- name: Facts
  hosts: all
  become: yes

################################################################################
# Operating system services                                                    #
################################################################################
- name: Message of the Day
  hosts: motd
  become: yes
  roles:
    - motd

- name: Mail
  hosts: mail
  become: yes
  roles:
    - mail

################################################################################
# Databases                                                                    #
################################################################################
- name: Redis
  hosts: redis
  become: yes
  roles:
    - redis

- name: PostgreSQL
  hosts: postgresql
  become: yes
  roles:
    - postgresql

- name: MariaDB
  hosts: mariadb
  become: yes
  roles:
    - mariadb

- name: Elasticsearch
  hosts: elasticsearch
  become: yes
  roles:
    - elasticsearch

################################################################################
# Frontend services                                                            #
################################################################################
- name: MailHog
  hosts: mailhog
  become: yes
  roles:
    - mailhog

- name: Demo
  hosts: demo
  become: yes
  roles:
    - demo
